var e="datapos-connector-data-file-store-emulator",t=(e=>(e.JSON="json",e.Table="table",e.Uint8Array="uint8Array",e))(t||{}),o=(e=>(e.File="file",e.Folder="folder",e))(o||{});const n=e=>{switch(e){case"csv":return"text/csv";case"tab":case"tsv":return"text/tab-separated-values";case"xls":return"application/vnd.ms-excel";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";default:return"application/octet-stream"}},s="https://firebasestorage.googleapis.com/v0/b/datapos-v00-dev-alpha.appspot.com/o/fileStore";class r{abortController;connectionItem;id;version;constructor(t){this.abortController=void 0,this.connectionItem=t,this.id=e,this.version="0.1.493"}abort(){this.abortController&&(this.abortController.abort(),this.abortController=void 0)}getPreviewInterface(){return{connector:this,previewFileEntry:c}}getReadInterface(){return{connector:this,readFileEntry:d}}async retrieveEntries(e,t,o){return await i(o)}}const i=e=>new Promise(((t,o)=>{try{const o=e.folderPath||"",n=[];o.startsWith("/SAP Employee Central Extract")?(n.push(a("/SAP Employee Central Extract","ADDRESS_INFO.csv",208015)),n.push(a("/SAP Employee Central Extract","COMP_CUR_CONV.csv",2245)),n.push(a("/SAP Employee Central Extract","EMP_COMP_INFO.csv",1665179)),n.push(a("/SAP Employee Central Extract","EMP_PAYCOMP_RECURRING.csv",1551764)),n.push(a("/SAP Employee Central Extract","EMPLOYMENT_INFO.csv",128575)),n.push(a("/SAP Employee Central Extract","EVENT_REASONS.csv",7775)),n.push(a("/SAP Employee Central Extract","FREQUENCY.csv",1704)),n.push(a("/SAP Employee Central Extract","GENERIC_OBJECTS.csv",1662477)),n.push(a("/SAP Employee Central Extract","GENERIC_RELATIONSHIPS.csv",98782)),n.push(a("/SAP Employee Central Extract","JOB_CLASS.csv",338260)),n.push(a("/SAP Employee Central Extract","JOB_INFO.csv",1546379)),n.push(a("/SAP Employee Central Extract","LABELS.csv",126838)),n.push(a("/SAP Employee Central Extract","LOCATIONS.csv",2995)),n.push(a("/SAP Employee Central Extract","PAY_COMPONENT.csv",1234)),n.push(a("/SAP Employee Central Extract","PERSON_INFO_GLOBAL.csv",82438)),n.push(a("/SAP Employee Central Extract","PERSON.csv",44896)),n.push(a("/SAP Employee Central Extract","PERSONAL_DATA.csv",105949)),n.push(a("/SAP Employee Central Extract","PICKLISTS.csv",78044)),n.push(a("/SAP Employee Central Extract","TERRITORY.csv",8541))):o.startsWith("/Test Files")?n.push(l("/Encoding",21)):o.startsWith("/Encoding")?(n.push(a("/Test Files/Encoding","big5",614)),n.push(a("/Test Files/Encoding","euc-jp",3919)),n.push(a("/Test Files/Encoding","euc-kr",2480)),n.push(a("/Test Files/Encoding","gb18030",1665)),n.push(a("/Test Files/Encoding","iso-2022-jp",2924)),n.push(a("/Test Files/Encoding","iso-8859-2",1600)),n.push(a("/Test Files/Encoding","iso-8859-5",1024)),n.push(a("/Test Files/Encoding","iso-8859-6",2241)),n.push(a("/Test Files/Encoding","iso-8859-7",1033)),n.push(a("/Test Files/Encoding","koi8-r",1024)),n.push(a("/Test Files/Encoding","shift_jis",2816)),n.push(a("/Test Files/Encoding","utf-16be",1334)),n.push(a("/Test Files/Encoding","utf-16le",1334)),n.push(a("/Test Files/Encoding","utf-8",1125)),n.push(a("/Test Files/Encoding","windows-1250",1617)),n.push(a("/Test Files/Encoding","windows-1251",1024)),n.push(a("/Test Files/Encoding","windows-1252",2976)),n.push(a("/Test Files/Encoding","windows-1253",1052)),n.push(a("/Test Files/Encoding","windows-1254",2445)),n.push(a("/Test Files/Encoding","windows-1255",2405)),n.push(a("/Test Files/Encoding","windows-1256",2241))):(n.push(l("/SAP Employee Central Extract",19)),n.push(l("/Test Files",7))),t({cursor:void 0,isMore:!1,entries:n,totalCount:n.length})}catch(e){o(e)}})),l=(e,t)=>{const n=(e=>{if(e){let t,o;if(e.endsWith("/")?(t=e.lastIndexOf("/",e.length-2),o=e.length-1):(t=e.lastIndexOf("/"),o=e.length),t>-1)return e.substring(t+1,o)}})(e);return{childEntryCount:t,folderPath:e,encodingId:void 0,extension:void 0,handle:void 0,id:void 0,label:n,lastModifiedAt:void 0,mimeType:void 0,name:n,referenceId:void 0,size:void 0,typeId:o.Folder}},a=(e,t,s)=>{const r=(e=>{if(e){const t=e.lastIndexOf(".");if(t>-1)return e.substring(t+1)}})(t);return{childEntryCount:void 0,folderPath:e,encodingId:void 0,extension:r,handle:void 0,id:t,label:t,lastModifiedAt:Date.parse("2022-01-03T23:33:00+00:00"),mimeType:n(r),name:t,referenceId:void 0,size:s,typeId:o.File}},c=async(e,o,n,r,i)=>{e.abortController=new AbortController;const l=e.abortController.signal,a={Range:`bytes=0-${i.chunkSize||4096}`},c=await fetch(`${s}${encodeURIComponent(`${o.folderPath}/${o.fileName}`)}?alt=media`,{headers:a,signal:l});if(e.abortController=void 0,!c.ok){const e={body:{context:"previewFileEntry",message:await c.text()},statusCode:c.status,statusText:c.statusText};throw new Error("Unable to preview entry.|"+JSON.stringify(e))}return{data:new Uint8Array(await c.arrayBuffer()),fields:void 0,typeId:t.Uint8Array}},d=async(e,t,o,n,r,i)=>{e.abortController=new AbortController;const l=e.abortController.signal,a=await fetch(`${s}${encodeURIComponent(`${t.folderPath}/${t.fileName}`)}?alt=media`,{signal:l});let c=[];const d=[];l.throwIfAborted();const p=i.parse({cast:(e,t)=>(d[t.index]={isQuoted:t.quoting},e),delimiter:t.preview.valueDelimiterId,info:!0,relax_column_count:!0,relax_quotes:!0});p.on("readable",(()=>{let e;for(;null!==(e=p.read());)l.throwIfAborted(),c.push({fieldInfos:d,fieldValues:e.record}),c.length<1e3||(r.chunk(c),c=[])})),p.on("error",(e=>r.error(e))),p.on("end",(()=>{l.throwIfAborted(),e.abortController=void 0,c.length>0&&(r.chunk(c),c=[]),r.complete({commentLineCount:p.info.comment_lines,emptyLineCount:p.info.empty_lines,lineCount:p.info.lines,recordCount:p.info.records})}));const u=a.body.pipeThrough(new TextDecoderStream(t.preview.encodingId)).getReader();let E;for(;!(E=await u.read()).done;)l.throwIfAborted(),p.write(E.value,(e=>{e&&r.error(e)}));p.end()};export{r as default};
