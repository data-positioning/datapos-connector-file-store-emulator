var e,t,n,o,i,r,s,a,l,c,d,u,p,h,E,m,f,v="datapos-connector-data-file-store-emulator";!function(e){e.Proposed="proposed",e.UnderReview="under-review",e.PreAlpha="pre-alpha",e.Alpha="alpha",e.Beta="beta",e.ReleaseCandidate="release-candidate",e.GeneralAvailability="general-availability",e.Unavailable="unavailable"}(e||(e={})),function(e){e.Connection="connection",e.ContextModel="contextModel",e.DataConnector="dataConnector",e.NodeConnector="nodeConnector",e.UsageKit="usageKit"}(t||(t={})),function(e){e.APIKey="apiKey",e.Disabled="disabled",e.OAuth2="oAuth2",e.None="none"}(n||(n={})),function(e){e.Bidirectional="bidirectional",e.Destination="destination",e.Node="node",e.Source="source",e.None="none"}(o||(o={})),function(e){e.File="file",e.Folder="folder"}(i||(i={})),function(e){e.JSON="json",e.Table="table",e.Uint8Array="uint8Array"}(r||(r={})),function(e){e.Binary="binary",e.Boolean="boolean",e.Date="date",e.DateTime="dateTime",e.DateTimeOffset="dateTimeOffset",e.DecimalNumber="decimalNumber",e.Object="object",e.String="string",e.Time="time",e.Unknown="unknown",e.WholeNumber="wholeNumber"}(s||(s={})),function(e){e.Binary="binary",e.Boolean="boolean",e.Byte="byte",e.Date="date",e.DateTime="dateTime",e.DateTimeOffset="dateTimeOffset",e.Decimal="decimal",e.Double="double",e.Int8="int8",e.Int16="int16",e.Int32="int32",e.Int64="int64",e.Object="object",e.Single="single",e.String="string",e.Time="time",e.Unknown="unknown"}(a||(a={})),function(e){e.Dimension="dimension",e.Entity="entity",e.EventQuery="eventQuery",e.SourceView="sourceView",e.Workbook="workbook"}(l||(l={})),function(e){e.Data="data",e.Events="events",e.Facts="facts"}(c||(c={})),function(e){e.Hash="#",e.Other="",e.None="\0"}(d||(d={})),function(e){e.DelimitedText="dtv",e.EntityEvent="e/e",e.JSON="json",e.SPSS="spss",e.Table="table",e.XLS="xls",e.XLSX="xlsx",e.XML="xml"}(u||(u={})),function(e){e.CarriageReturn="\r",e.CarriageReturnNewline="\r\n",e.Newline="\n",e.Other=""}(p||(p={})),function(e){e.DoubleQuote='"',e.Other="",e.None="\0"}(h||(h={})),function(e){e.DoubleQuote='"',e.SingleQuote="'",e.Other="",e.None="\0"}(E||(E={})),function(e){e.Colon=":",e.Comma=",",e.ExclamationMark="!",e.Other="",e.RecordSeparator="0x1E",e.Semicolon=";",e.Space=" ",e.Tab="\t",e.Underscore="_",e.UnitSeparator="0x1F",e.VerticalBar="|"}(m||(m={})),function(e){e.Both="both",e.Left="left",e.Right="right",e.None="none"}(f||(f={}));const C=e=>{switch(e){case"csv":return"text/csv";case"tab":case"tsv":return"text/tab-separated-values";case"xls":return"application/vnd.ms-excel";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";default:return"application/octet-stream"}},b="https://firebasestorage.googleapis.com/v0/b/datapos-v00-dev-alpha.appspot.com/o/fileStore";class g{abortController;connectionItem;id;version;constructor(e){this.abortController=void 0,this.connectionItem=e,this.id=v,this.version="0.1.417"}abort(){this.abortController&&(this.abortController.abort(),this.abortController=void 0)}getPreviewInterface(){return{connector:this,previewFileEntry:x}}getReadInterface(){return{connector:this,readFileEntry:w}}async retrieveEntries(e,t,n){return await y(n)}}const y=e=>new Promise(((t,n)=>{try{const n=e.folderPath||"",o=[];n.startsWith("/SAP Employee Central Extract")?(o.push(T("/SAP Employee Central Extract","ADDRESS_INFO.csv",208015)),o.push(T("/SAP Employee Central Extract","COMP_CUR_CONV.csv",2245)),o.push(T("/SAP Employee Central Extract","EMP_COMP_INFO.csv",1665179)),o.push(T("/SAP Employee Central Extract","EMP_PAYCOMP_RECURRING.csv",1551764)),o.push(T("/SAP Employee Central Extract","EMPLOYMENT_INFO.csv",128575)),o.push(T("/SAP Employee Central Extract","EVENT_REASONS.csv",7775)),o.push(T("/SAP Employee Central Extract","FREQUENCY.csv",1704)),o.push(T("/SAP Employee Central Extract","GENERIC_OBJECTS.csv",1662477)),o.push(T("/SAP Employee Central Extract","GENERIC_RELATIONSHIPS.csv",98782)),o.push(T("/SAP Employee Central Extract","JOB_CLASS.csv",338260)),o.push(T("/SAP Employee Central Extract","JOB_INFO.csv",1546379)),o.push(T("/SAP Employee Central Extract","LABELS.csv",126838)),o.push(T("/SAP Employee Central Extract","LOCATIONS.csv",2995)),o.push(T("/SAP Employee Central Extract","PAY_COMPONENT.csv",1234)),o.push(T("/SAP Employee Central Extract","PERSON_INFO_GLOBAL.csv",82438)),o.push(T("/SAP Employee Central Extract","PERSON.csv",44896)),o.push(T("/SAP Employee Central Extract","PERSONAL_DATA.csv",105949)),o.push(T("/SAP Employee Central Extract","PICKLISTS.csv",78044)),o.push(T("/SAP Employee Central Extract","TERRITORY.csv",8541))):n.startsWith("/Test Files")?o.push(S("/Encoding",21)):n.startsWith("/Encoding")?(o.push(T("/Test Files/Encoding","big5",614)),o.push(T("/Test Files/Encoding","euc-jp",3919)),o.push(T("/Test Files/Encoding","euc-kr",2480)),o.push(T("/Test Files/Encoding","gb18030",1665)),o.push(T("/Test Files/Encoding","iso-2022-jp",2924)),o.push(T("/Test Files/Encoding","iso-8859-2",1600)),o.push(T("/Test Files/Encoding","iso-8859-5",1024)),o.push(T("/Test Files/Encoding","iso-8859-6",2241)),o.push(T("/Test Files/Encoding","iso-8859-7",1033)),o.push(T("/Test Files/Encoding","koi8-r",1024)),o.push(T("/Test Files/Encoding","shift_jis",2816)),o.push(T("/Test Files/Encoding","utf-16be",1334)),o.push(T("/Test Files/Encoding","utf-16le",1334)),o.push(T("/Test Files/Encoding","utf-8",1125)),o.push(T("/Test Files/Encoding","windows-1250",1617)),o.push(T("/Test Files/Encoding","windows-1251",1024)),o.push(T("/Test Files/Encoding","windows-1252",2976)),o.push(T("/Test Files/Encoding","windows-1253",1052)),o.push(T("/Test Files/Encoding","windows-1254",2445)),o.push(T("/Test Files/Encoding","windows-1255",2405)),o.push(T("/Test Files/Encoding","windows-1256",2241))):(o.push(S("/SAP Employee Central Extract",19)),o.push(S("/Test Files",7))),t({cursor:void 0,isMore:!1,entries:o,totalCount:o.length})}catch(e){n(e)}})),S=(e,t)=>{const n=(e=>{if(e){let t,n;if(e.endsWith("/")?(t=e.lastIndexOf("/",e.length-2),n=e.length-1):(t=e.lastIndexOf("/"),n=e.length),t>-1)return e.substring(t+1,n)}})(e);return{childEntryCount:t,folderPath:e,encodingId:void 0,extension:void 0,handle:void 0,id:void 0,label:n,lastModifiedAt:void 0,mimeType:void 0,name:n,referenceId:void 0,size:void 0,typeId:i.Folder}},T=(e,t,n)=>{const o=(e=>{if(e){const t=e.lastIndexOf(".");if(t>-1)return e.substring(t+1)}})(t);return{childEntryCount:void 0,folderPath:e,encodingId:void 0,extension:o,handle:void 0,id:t,label:t,lastModifiedAt:Date.parse("2022-01-03T23:33:00+00:00"),mimeType:C(o),name:t,referenceId:void 0,size:n,typeId:i.File}},x=async(e,t,n,o,i)=>{e.abortController=new AbortController;const s=e.abortController.signal,a={Range:`bytes=0-${i.chunkSize||4096}`},l=await fetch(`${b}${encodeURIComponent(`${t.folderPath}/${t.fileName}`)}?alt=media`,{headers:a,signal:s});if(e.abortController=void 0,!l.ok){const e={body:{context:"previewFileEntry",message:await l.text()},statusCode:l.status,statusText:l.statusText};throw new Error("Unable to preview entry.|"+JSON.stringify(e))}return{data:new Uint8Array(await l.arrayBuffer()),fields:void 0,typeId:r.Uint8Array}},w=async(e,t,n,o,i,r)=>{e.abortController=new AbortController;const s=e.abortController.signal,a=await fetch(`${b}${encodeURIComponent(`${t.folderPath}/${t.fileName}`)}?alt=media`,{signal:s});let l=[];const c=[];s.throwIfAborted();const d=r.csvParse.parse({cast:(e,t)=>(c[t.index]={isQuoted:t.quoting},e),delimiter:t.preview.valueDelimiterId,info:!0,relax_column_count:!0,relax_quotes:!0});d.on("readable",(()=>{let e;for(;null!==(e=d.read());)s.throwIfAborted(),l.push({fieldInfos:c,fieldValues:e.record}),l.length<1e3||(i.chunk(l),l=[])})),d.on("error",(e=>i.error(e))),d.on("end",(()=>{s.throwIfAborted(),e.abortController=void 0,l.length>0&&(i.chunk(l),l=[]),i.complete({commentLineCount:d.info.comment_lines,emptyLineCount:d.info.empty_lines,lineCount:d.info.lines,recordCount:d.info.records})}));const u=a.body.pipeThrough(new TextDecoderStream(t.preview.encodingId)).getReader();let p;for(;!(p=await u.read()).done;)s.throwIfAborted(),d.write(p.value,(e=>{e&&i.error(e)}));d.end()};export{g as default};
